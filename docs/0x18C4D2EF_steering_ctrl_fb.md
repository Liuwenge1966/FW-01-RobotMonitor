# 转向控制反馈帧（steering_ctrl_fb）协议说明

## 基本信息

- **报文名称**：`steering_ctrl_fb`  
- **发送节点**：线控底盘  
- **接收节点**：决策控制单元  
- **Msg ID**：`0x18C4D2EF`  
- **周期**：10 ms（每 10 毫秒发送一次）  
- **接收超时**：无（不设置超时机制）  
- **报文长度**：8 字节  
- **起始字节**：`byte[0]`

> **注**：此帧为 **底盘向决策单元上报的转向与运动状态反馈**，用于实现闭环控制和状态监控。

---

## 字段解析

| 字节位置 | 功能字段                     | 数据类型  | 起始位 | 信号长度（bit） | 说明 |
|----------|------------------------------|-----------|--------|------------------|------|
| byte [0] | 当前档位反馈                 | Unsigned  | 0      | 4                | 底盘当前实际档位：<br>• `00`: disable<br>• `01`: 驻车档<br>• `02`: 空挡<br>• `03`: FR-档（未启用）<br>• `05`: 4T4D-档<br>• `07`: 横移-档 |
| byte [0] | 当前车体速度反馈             | Signed    | 4      | 16               | 单位：`0.001 m/s/bit`<br>正负值表示前进或后退方向 |
| byte [2] | 当前车体转向角反馈           | Signed    | 20     | 16               | 单位：`0.01°/bit`<br>表示车辆实际转向角度（左转为负，右转为正） |
| byte [4] | 当前车体侧偏角反馈           | Signed    | 36     | 16               | 单位：`0.01°/bit`<br>表示车辆相对于目标方向的横向偏转角度 |
| byte [6] | Alive Rolling Counter（心跳信号 / 循环计数器） | Unsigned | 52     | 4                | 每发一帧，数值加 1；达到最大值后从 0 重新开始。<br>用于检测通信是否丢包或链路异常。 |
| byte [7] | Check BCC（消息异或校验）    | Unsigned | 56     | 8                | 校验位，通常为所有字节的异或（XOR）结果，用于验证数据完整性 |

> **注**：多个字段共用同一字节（如 `byte[0]`），需通过起始位进行位域划分。例如：
> - `当前档位反馈` 占 `bit 0~3`
> - `当前车体速度反馈` 占 `bit 4~19`

---

## 补充说明

### 1. **高频率反馈**
- 报文周期为 **10ms**，属于高速反馈帧，确保决策单元能实时获取车辆运动状态。
- 适用于自动驾驶系统中的 **转向闭环控制** 和 **路径跟踪算法**。

### 2. **状态反馈完整性**
- 提供了关键的转向与运动状态信息：
  - 档位状态
  - 实际车速
  - 实际转向角
  - 侧偏角
- 可用于：
  - 控制误差计算
  - 状态估计与融合
  - 转向执行效果评估

### 3. **心跳与校验机制**
- **Alive Rolling Counter**：每帧递增，用于判断通信是否正常。若连续多帧未收到或计数器未变化，则判定通信中断。
- **Check BCC**：提供基本的数据校验能力，防止传输错误导致误判。

---

## 总结

`steering_ctrl_fb` 是由 **线控底盘** 向 **决策控制单元** 发送的 **转向与运动状态反馈帧**，其核心功能包括：

- 上报当前档位
- 反馈车体速度、转向角、侧偏角
- 提供心跳信号与数据校验

该帧具有 **高实时性（10ms 周期）** 和 **高可靠性**，是实现自动驾驶系统中精确转向控制的关键组成部分。